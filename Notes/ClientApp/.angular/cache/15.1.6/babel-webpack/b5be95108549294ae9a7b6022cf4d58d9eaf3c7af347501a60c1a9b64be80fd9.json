{"ast":null,"code":"import { UserDetails } from '../auth/user.model';\nimport { environment } from \"src/environments/environment\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class AuthService {\n  constructor(http, baseUrl) {\n    this.http = http;\n    this.baseUrl = '';\n    this.isAuthenticated = false;\n    this.userDetails = UserDetails.default;\n    this.expiresIn = 0;\n    this.baseUrl = baseUrl;\n  }\n  getUser(email) {\n    return this.http.get(this.baseUrl + 'register?email=' + email);\n  }\n  registerUser(register) {\n    return this.http.post(this.baseUrl + 'register', register);\n  }\n  loginUser(login) {\n    return this.http.post(this.baseUrl + 'login', login);\n  }\n  logout() {\n    return this.http.post(this.baseUrl + 'logout', {});\n  }\n  getUserSession() {\n    return this.http.get(this.baseUrl + 'login');\n  }\n  setIsAuthenticate(value) {\n    this.isAuthenticated = value;\n    if (value) {\n      setTimeout(() => {\n        this.logout();\n        this.setIsAuthenticate(false);\n      }, environment.SessionTime);\n    } else {\n      this.clearSessionTimers();\n    }\n  }\n  setSessionTimer(timeleft) {\n    setTimeout(() => {\n      this.logout();\n      this.setIsAuthenticate(false);\n    }, timeleft * 1000);\n  }\n  clearSessionTimers() {\n    var id = window.setTimeout(function () {}, 0);\n    while (id--) {\n      window.clearTimeout(id);\n    }\n  }\n  get authenticated() {\n    return this.isAuthenticated;\n  }\n}\nAuthService.ɵfac = function AuthService_Factory(t) {\n  return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject('BASE_URL'));\n};\nAuthService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AuthService,\n  factory: AuthService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"AAMA,SAASA,WAAW,QAAqB,oBAAoB;AAC7D,SAASC,WAAW,QAAQ,8BAA8B;;;AAG1D,OAAM,MAAOC,WAAW;EAMpBC,YAAoBC,IAAe,EAAqBC,OAAe;IAAnD,SAAI,GAAJD,IAAI;IALxB,YAAO,GAAC,EAAE;IACF,oBAAe,GAAC,KAAK;IACtB,gBAAW,GAACJ,WAAW,CAACM,OAAO;IAC/B,cAAS,GAAC,CAAC;IAId,IAAI,CAACD,OAAO,GAACA,OAAO;EACxB;EAEAE,OAAO,CAACC,KAAY;IAChB,OAAO,IAAI,CAACJ,IAAI,CAACK,GAAG,CAAU,IAAI,CAACJ,OAAO,GAAC,iBAAiB,GAACG,KAAK,CAAC;EACvE;EAEAE,YAAY,CAACC,QAAiB;IAC1B,OAAO,IAAI,CAACP,IAAI,CAACQ,IAAI,CAAkB,IAAI,CAACP,OAAO,GAAC,UAAU,EAACM,QAAQ,CAAC;EAC5E;EAEAE,SAAS,CAACC,KAAW;IACjB,OAAO,IAAI,CAACV,IAAI,CAACQ,IAAI,CAAkB,IAAI,CAACP,OAAO,GAAC,OAAO,EAACS,KAAK,CAAC;EACtE;EAEAC,MAAM;IACF,OAAO,IAAI,CAACX,IAAI,CAACQ,IAAI,CAAC,IAAI,CAACP,OAAO,GAAC,QAAQ,EAAC,EAAE,CAAC;EACnD;EAEAW,cAAc;IACV,OAAO,IAAI,CAACZ,IAAI,CAACK,GAAG,CAAc,IAAI,CAACJ,OAAO,GAAC,OAAO,CAAC;EAC3D;EAEAY,iBAAiB,CAACC,KAAa;IAC3B,IAAI,CAACC,eAAe,GAACD,KAAK;IAC1B,IAAGA,KAAK,EAAC;MACLE,UAAU,CAAC,MAAI;QACX,IAAI,CAACL,MAAM,EAAE;QACb,IAAI,CAACE,iBAAiB,CAAC,KAAK,CAAC;MACjC,CAAC,EAAChB,WAAW,CAACoB,WAAW,CAAC;KAC7B,MACG;MACA,IAAI,CAACC,kBAAkB,EAAE;;EAEjC;EAEAC,eAAe,CAACC,QAAe;IAC3BJ,UAAU,CAAC,MAAI;MACX,IAAI,CAACL,MAAM,EAAE;MACb,IAAI,CAACE,iBAAiB,CAAC,KAAK,CAAC;IACjC,CAAC,EAACO,QAAQ,GAAC,IAAI,CAAC;EACpB;EAEAF,kBAAkB;IACd,IAAIG,EAAE,GAAGC,MAAM,CAACN,UAAU,CAAC,aAAY,CAAC,EAAE,CAAC,CAAC;IAE5C,OAAOK,EAAE,EAAE,EAAE;MACTC,MAAM,CAACC,YAAY,CAACF,EAAE,CAAC;;EAE/B;EAEA,IAAIG,aAAa;IACb,OAAO,IAAI,CAACT,eAAe;EAC/B;;AA7DSjB,WAAW;mBAAXA,WAAW,0CAMwB,UAAU;AAAA;AAN7CA,WAAW;SAAXA,WAAW;EAAA2B,SAAX3B,WAAW;EAAA4B,YADA;AAAM","names":["UserDetails","environment","AuthService","constructor","http","baseUrl","default","getUser","email","get","registerUser","register","post","loginUser","login","logout","getUserSession","setIsAuthenticate","value","isAuthenticated","setTimeout","SessionTime","clearSessionTimers","setSessionTimer","timeleft","id","window","clearTimeout","authenticated","factory","providedIn"],"sourceRoot":"","sources":["D:\\mine\\projects\\dotnet-angular\\Notes\\Notes\\ClientApp\\src\\app\\components\\auth\\auth.service.ts"],"sourcesContent":["import { HttpClient } from \"@angular/common/http\";\r\nimport { Inject, Injectable } from \"@angular/core\";\r\nimport { ServerModule } from \"@angular/platform-server\";\r\nimport { Register } from \"./register/register.model\";\r\nimport { Login } from \"./login/login.model\";\r\nimport { ResponseMessage } from \"src/app/shared/response-message.model\";\r\nimport { UserDetails, UserSession } from '../auth/user.model';\r\nimport { environment } from \"src/environments/environment\";\r\n\r\n@Injectable({providedIn:'root'})\r\nexport class AuthService{\r\n    baseUrl='';\r\n    private isAuthenticated=false;\r\n    public userDetails=UserDetails.default;\r\n    public expiresIn=0;\r\n\r\n    constructor(private http:HttpClient,@Inject('BASE_URL') baseUrl: string)\r\n    {\r\n        this.baseUrl=baseUrl;\r\n    }\r\n\r\n    getUser(email:string){\r\n        return this.http.get<boolean>(this.baseUrl+'register?email='+email)\r\n    }\r\n\r\n    registerUser(register:Register){\r\n        return this.http.post<ResponseMessage>(this.baseUrl+'register',register)\r\n    }\r\n\r\n    loginUser(login:Login){\r\n        return this.http.post<ResponseMessage>(this.baseUrl+'login',login)\r\n    }\r\n\r\n    logout(){\r\n        return this.http.post(this.baseUrl+'logout',{})\r\n    }\r\n\r\n    getUserSession(){\r\n        return this.http.get<UserSession>(this.baseUrl+'login')\r\n    }\r\n\r\n    setIsAuthenticate(value:boolean){\r\n        this.isAuthenticated=value;\r\n        if(value){\r\n            setTimeout(()=>{\r\n                this.logout()\r\n                this.setIsAuthenticate(false)\r\n            },environment.SessionTime)    \r\n        }\r\n        else{\r\n            this.clearSessionTimers()\r\n        }\r\n    }\r\n\r\n    setSessionTimer(timeleft:number){\r\n        setTimeout(()=>{\r\n            this.logout()\r\n            this.setIsAuthenticate(false)\r\n        },timeleft*1000)\r\n    }\r\n\r\n    clearSessionTimers(){\r\n        var id = window.setTimeout(function() {}, 0);\r\n\r\n        while (id--) {\r\n            window.clearTimeout(id);\r\n        }\r\n    }    \r\n\r\n    get authenticated(){\r\n        return this.isAuthenticated;\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}